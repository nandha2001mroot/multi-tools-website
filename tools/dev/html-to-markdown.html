<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML to Markdown - MultiTools</title>
    <meta name="description" content="Convert HTML to Markdown. Free HTML to Markdown converter tool.">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="../../css/style.css" rel="stylesheet">
</head>
<body>
    <div id="header-placeholder"></div>

    <div class="container tool-container">
        <div class="tool-header">
            <h1><i class="fas fa-code text-dark"></i> HTML to Markdown</h1>
            <p class="tool-description">Convert HTML to Markdown format with proper formatting.</p>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-code"></i> HTML Input</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="htmlInput" class="form-label">Enter HTML:</label>
                            <textarea class="form-control" id="htmlInput" rows="12" placeholder="<h1>Title</h1><p>Content</p>"></textarea>
                        </div>
                        
                        <button class="btn btn-dark w-100" id="convertBtn">
                            <i class="fas fa-exchange-alt"></i> Convert to Markdown
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-file-alt"></i> Markdown Output</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="markdownOutput" class="form-label">Markdown:</label>
                            <textarea class="form-control" id="markdownOutput" rows="12" readonly></textarea>
                        </div>
                        
                        <div class="d-flex gap-2">
                            <button class="btn btn-success" id="copyBtn">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button class="btn btn-outline-secondary" id="clearBtn">
                                <i class="fas fa-eraser"></i> Clear
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-3">
                    <div class="card-header">
                        <h5><i class="fas fa-info-circle"></i> HTML to Markdown Mapping</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>HTML</th>
                                        <th>Markdown</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><h1>Title</h1></td>
                                        <td># Title</td>
                                    </tr>
                                    <tr>
                                        <td><h2>Title</h2></td>
                                        <td>## Title</td>
                                    </tr>
                                    <tr>
                                        <td><p>Text</p></td>
                                        <td>Text</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Text</strong></td>
                                        <td>**Text**</td>
                                    </tr>
                                    <tr>
                                        <td><em>Text</em></td>
                                        <td>*Text*</td>
                                    </tr>
                                    <tr>
                                        <td><a href="url">Text</a></td>
                                        <td>[Text](url)</td>
                                    </tr>
                                    <tr>
                                        <td><img src="url" alt="alt"></td>
                                        <td>![alt](url)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../js/main.js"></script>
    <script>
        loadHeaderFooter();

        const htmlInput = document.getElementById('htmlInput');
        const markdownOutput = document.getElementById('markdownOutput');
        const convertBtn = document.getElementById('convertBtn');
        const copyBtn = document.getElementById('copyBtn');
        const clearBtn = document.getElementById('clearBtn');

        function htmlToMarkdown(html) {
            // Create a temporary DOM element to parse HTML
            const temp = document.createElement('div');
            temp.innerHTML = html;

            // Convert HTML elements to markdown
            let markdown = html;
            
            // Headers
            markdown = markdown.replace(/<h1[^>]*>(.*?)<\/h1>/gi, '# $1');
            markdown = markdown.replace(/<h2[^>]*>(.*?)<\/h2>/gi, '## $1');
            markdown = markdown.replace(/<h3[^>]*>(.*?)<\/h3>/gi, '### $1');
            markdown = markdown.replace(/<h4[^>]*>(.*?)<\/h4>/gi, '#### $1');
            markdown = markdown.replace(/<h5[^>]*>(.*?)<\/h5>/gi, '##### $1');
            markdown = markdown.replace(/<h6[^>]*>(.*?)<\/h6>/gi, '###### $1');
            
            // Bold and italic
            markdown = markdown.replace(/<strong[^>]*>(.*?)<\/strong>/gi, '**$1**');
            markdown = markdown.replace(/<b[^>]*>(.*?)<\/b>/gi, '**$1**');
            markdown = markdown.replace(/<em[^>]*>(.*?)<\/em>/gi, '*$1*');
            markdown = markdown.replace(/<i[^>]*>(.*?)<\/i>/gi, '*$1*');
            
            // Links
            markdown = markdown.replace(/<a[^>]+href=["']([^"']*)["'][^>]*>(.*?)<\/a>/gi, '[$2]($1)');
            
            // Images
            markdown = markdown.replace(/<img[^>]+src=["']([^"']*)["'][^>]*alt=["']([^"']*)["'][^>]*>/gi, '![$2]($1)');
            
            // Lists
            markdown = markdown.replace(/<ul[^>]*>(.*?)<\/ul>/gs, function(match, p1) {
                return p1.replace(/<li[^>]*>(.*?)<\/li>/g, '- $1\n');
            });
            
            markdown = markdown.replace(/<ol[^>]*>(.*?)<\/ol>/gs, function(match, p1) {
                return p1.replace(/<li[^>]*>(.*?)<\/li>/g, function(liMatch, liContent, index) {
                    return (index + 1) + '. ' + liContent + '\n';
                });
            });
            
            // Paragraphs
            markdown = markdown.replace(/<p[^>]*>(.*?)<\/p>/gi, '$1\n\n');
            
            // Line breaks
            markdown = markdown.replace(/<br[^>]*>/gi, '\n');
            
            // Remove remaining HTML tags
            markdown = markdown.replace(/<[^>]*>/g, '');
            
            // Clean up extra whitespace
            markdown = markdown.replace(/\n\s*\n/g, '\n\n');
            markdown = markdown.trim();
            
            return markdown;
        }

        convertBtn.addEventListener('click', function() {
            const html = htmlInput.value.trim();
            if (!html) {
                alert('Please enter HTML to convert!');
                return;
            }
            
            const markdown = htmlToMarkdown(html);
            markdownOutput.value = markdown;
        });

        copyBtn.addEventListener('click', function() {
            if (markdownOutput.value) {
                ToolUtils.copyToClipboard(markdownOutput.value);
            }
        });

        clearBtn.addEventListener('click', function() {
            htmlInput.value = '';
            markdownOutput.value = '';
        });

        trackToolUsage('HTML to Markdown');
    </script>
</body>
</html>