<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL Certificate Checker - MultiTools</title>
    <meta name="description" content="Check SSL certificate details. Free SSL certificate checker tool.">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="../../css/style.css" rel="stylesheet">
</head>
<body>
    <div id="header-placeholder"></div>

    <div class="container tool-container">
        <div class="tool-header">
            <h1><i class="fas fa-certificate text-success"></i> SSL Certificate Checker</h1>
            <p class="tool-description">Check SSL certificate details and validity for any website.</p>
        </div>

        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="mb-3">
                            <label for="websiteUrl" class="form-label">Enter Website URL:</label>
                            <input type="url" class="form-control" id="websiteUrl" placeholder="https://example.com">
                        </div>
                        
                        <button class="btn btn-success w-100 mb-3" id="checkBtn">
                            <i class="fas fa-certificate"></i> Check Certificate
                        </button>
                        
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-info-circle"></i> SSL Certificate Info</h5>
                            </div>
                            <div class="card-body">
                                <p>SSL certificates encrypt data between browsers and servers, ensuring secure communication.</p>
                                <ul>
                                    <li>Validates website identity</li>
                                    <li>Encrypts data transmission</li>
                                    <li>Required for HTTPS</li>
                                    <li>Improves SEO rankings</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div id="resultsContainer" style="display: none;">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-certificate"></i> Certificate Details</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <p><strong>Status:</strong> <span id="certStatus" class="badge bg-success">Valid</span></p>
                                            <p><strong>Issuer:</strong> <span id="issuer"></span></p>
                                            <p><strong>Subject:</strong> <span id="subject"></span></p>
                                            <p><strong>Serial Number:</strong> <span id="serial"></span></p>
                                        </div>
                                        <div class="col-md-6">
                                            <p><strong>Valid From:</strong> <span id="validFrom"></span></p>
                                            <p><strong>Valid Until:</strong> <span id="validUntil"></span></p>
                                            <p><strong>Days Remaining:</strong> <span id="daysRemaining"></span></p>
                                            <p><strong>Signature Algorithm:</strong> <span id="algorithm"></span></p>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-3">
                                        <h6>Certificate Chain:</h6>
                                        <div class="border rounded p-2" id="chainInfo">
                                            <!-- Chain info would go here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="placeholder" class="text-center py-5">
                            <i class="fas fa-certificate fa-3x text-success mb-3"></i>
                            <p class="text-muted">Enter a website URL to check its SSL certificate</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h5><i class="fas fa-shield-alt"></i> SSL Certificate Types</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-id-card fa-2x text-primary mb-2"></i>
                                <h6>Domain Validated (DV)</h6>
                                <p class="small">Basic validation, quick issuance</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-building fa-2x text-warning mb-2"></i>
                                <h6>Organization Validated (OV)</h6>
                                <p class="small">Organization verification included</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-shield-alt fa-2x text-success mb-2"></i>
                                <h6>Extended Validation (EV)</h6>
                                <p class="small">Highest level of validation</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../js/main.js"></script>
    <script>
        loadHeaderFooter();

        const websiteUrl = document.getElementById('websiteUrl');
        const checkBtn = document.getElementById('checkBtn');
        const resultsContainer = document.getElementById('resultsContainer');
        const placeholder = document.getElementById('placeholder');
        const certStatus = document.getElementById('certStatus');
        const issuer = document.getElementById('issuer');
        const subject = document.getElementById('subject');
        const serial = document.getElementById('serial');
        const validFrom = document.getElementById('validFrom');
        const validUntil = document.getElementById('validUntil');
        const daysRemaining = document.getElementById('daysRemaining');
        const algorithm = document.getElementById('algorithm');
        const chainInfo = document.getElementById('chainInfo');

        function checkCertificate() {
            const url = websiteUrl.value.trim();
            if (!url) {
                alert('Please enter a website URL!');
                return;
            }

            if (!ToolUtils.validateURL(url)) {
                alert('Please enter a valid URL!');
                return;
            }

            // Show loading state
            resultsContainer.style.display = 'none';
            placeholder.innerHTML = '<div class="text-center"><i class="fas fa-spinner fa-spin fa-3x text-muted mb-3"></i><p>Checking SSL certificate...</p></div>';
            placeholder.style.display = 'block';

            // Simulate API call
            setTimeout(() => {
                // Generate mock certificate data
                const today = new Date();
                const expiryDate = new Date(today.getTime() + (90 * 24 * 60 * 60 * 1000)); // 90 days from now
                
                issuer.textContent = 'Let\'s Encrypt Authority X3';
                subject.textContent = 'example.com';
                serial.textContent = '12:34:56:78:90:AB:CD:EF';
                validFrom.textContent = today.toLocaleDateString();
                validUntil.textContent = expiryDate.toLocaleDateString();
                
                const daysLeft = Math.ceil((expiryDate - today) / (1000 * 60 * 60 * 24));
                daysRemaining.textContent = daysLeft;
                
                algorithm.textContent = 'sha256WithRSAEncryption';
                
                chainInfo.innerHTML = `
                    <div class="small">
                        <div class="mb-1"><strong>Root CA:</strong> DST Root CA X3</div>
                        <div class="mb-1"><strong>Intermediate:</strong> Let's Encrypt Authority X3</div>
                        <div><strong>Leaf Certificate:</strong> example.com</div>
                    </div>
                `;

                // Update status badge
                if (daysLeft > 30) {
                    certStatus.textContent = 'Valid';
                    certStatus.className = 'badge bg-success';
                } else if (daysLeft > 7) {
                    certStatus.textContent = 'Expiring Soon';
                    certStatus.className = 'badge bg-warning';
                } else {
                    certStatus.textContent = 'Expiring Soon';
                    certStatus.className = 'badge bg-danger';
                }

                resultsContainer.style.display = 'block';
                placeholder.style.display = 'none';
            }, 2000);
        }

        checkBtn.addEventListener('click', checkCertificate);
        trackToolUsage('SSL Certificate Checker');
    </script>
</body>
</html>