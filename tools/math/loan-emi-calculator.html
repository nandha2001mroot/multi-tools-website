<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan EMI Calculator - MultiTools</title>
    <meta name="description" content="Calculate loan EMI payments. Free loan EMI calculator tool.">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="../../css/style.css" rel="stylesheet">
</head>
<body>
    <div id="header-placeholder"></div>

    <div class="container tool-container">
        <div class="tool-header">
            <h1><i class="fas fa-money-bill-wave text-warning"></i> Loan EMI Calculator</h1>
            <p class="tool-description">Calculate your monthly loan EMI payments with detailed breakdown.</p>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-calculator"></i> Loan Details</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="loanAmount" class="form-label">Loan Amount:</label>
                            <input type="number" class="form-control" id="loanAmount" placeholder="Enter loan amount" value="100000">
                        </div>
                        
                        <div class="mb-3">
                            <label for="interestRate" class="form-label">Annual Interest Rate (%):</label>
                            <input type="number" class="form-control" id="interestRate" placeholder="Enter interest rate" value="8.5" step="0.01">
                        </div>
                        
                        <div class="mb-3">
                            <label for="loanTenure" class="form-label">Loan Tenure (Years):</label>
                            <input type="number" class="form-control" id="loanTenure" placeholder="Enter tenure in years" value="5">
                        </div>
                        
                        <button class="btn btn-warning w-100" id="calculateBtn">
                            <i class="fas fa-calculator"></i> Calculate EMI
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-chart-pie"></i> EMI Results</h5>
                    </div>
                    <div class="card-body text-center">
                        <div class="mb-4">
                            <h2 class="text-warning">Monthly EMI</h2>
                            <h1 id="monthlyEMI" class="display-4">₹0</h1>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-body">
                                        <h5>Total Interest</h5>
                                        <h3 id="totalInterest">₹0</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-body">
                                        <h5>Total Payment</h5>
                                        <h3 id="totalPayment">₹0</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <h6>Loan Summary:</h6>
                            <p><strong>Principal Amount:</strong> <span id="principalAmount">₹0</span></p>
                            <p><strong>Loan Period:</strong> <span id="loanPeriod">0</span> months</p>
                            <p><strong>Interest Rate:</strong> <span id="interestRateDisplay">0%</span></p>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-3">
                    <div class="card-header">
                        <h5><i class="fas fa-chart-bar"></i> Payment Breakdown</h5>
                    </div>
                    <div class="card-body">
                        <div class="progress mb-3">
                            <div class="progress-bar bg-success" id="principalBar" style="width: 0%" role="progressbar">Principal</div>
                            <div class="progress-bar bg-danger" id="interestBar" style="width: 0%" role="progressbar">Interest</div>
                        </div>
                        <div class="row">
                            <div class="col-6 text-center">
                                <p class="mb-0">Principal</p>
                                <p id="principalPercent">0%</p>
                            </div>
                            <div class="col-6 text-center">
                                <p class="mb-0">Interest</p>
                                <p id="interestPercent">0%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h5><i class="fas fa-info-circle"></i> About EMI Calculation</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6>EMI Formula:</h6>
                        <p>EMI = [P × R × (1+R)^N] / [(1+R)^N - 1]</p>
                        <ul>
                            <li><strong>P:</strong> Principal loan amount</li>
                            <li><strong>R:</strong> Monthly interest rate</li>
                            <li><strong>N:</strong> Number of monthly installments</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>Factors Affecting EMI:</h6>
                        <ul>
                            <li>Loan amount (higher amount = higher EMI)</li>
                            <li>Interest rate (higher rate = higher EMI)</li>
                            <li>Loan tenure (longer tenure = lower EMI)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../js/main.js"></script>
    <script>
        loadHeaderFooter();

        const loanAmount = document.getElementById('loanAmount');
        const interestRate = document.getElementById('interestRate');
        const loanTenure = document.getElementById('loanTenure');
        const calculateBtn = document.getElementById('calculateBtn');
        const monthlyEMI = document.getElementById('monthlyEMI');
        const totalInterest = document.getElementById('totalInterest');
        const totalPayment = document.getElementById('totalPayment');
        const principalAmount = document.getElementById('principalAmount');
        const loanPeriod = document.getElementById('loanPeriod');
        const interestRateDisplay = document.getElementById('interestRateDisplay');
        const principalBar = document.getElementById('principalBar');
        const interestBar = document.getElementById('interestBar');
        const principalPercent = document.getElementById('principalPercent');
        const interestPercent = document.getElementById('interestPercent');

        function calculateEMI() {
            const principal = parseFloat(loanAmount.value) || 0;
            const annualRate = parseFloat(interestRate.value) || 0;
            const years = parseFloat(loanTenure.value) || 0;

            if (principal <= 0 || annualRate <= 0 || years <= 0) {
                alert('Please enter valid loan details!');
                return;
            }

            const monthlyRate = annualRate / 12 / 100;
            const months = years * 12;

            // Calculate EMI
            const emi = principal * monthlyRate * Math.pow(1 + monthlyRate, months) / (Math.pow(1 + monthlyRate, months) - 1);
            
            // Calculate total payment and interest
            const totalPay = emi * months;
            const totalInt = totalPay - principal;

            // Update display
            monthlyEMI.textContent = '₹' + ToolUtils.formatNumber(emi.toFixed(2));
            totalInterest.textContent = '₹' + ToolUtils.formatNumber(totalInt.toFixed(2));
            totalPayment.textContent = '₹' + ToolUtils.formatNumber(totalPay.toFixed(2));
            principalAmount.textContent = '₹' + ToolUtils.formatNumber(principal.toFixed(2));
            loanPeriod.textContent = months;
            interestRateDisplay.textContent = annualRate + '%';

            // Calculate percentages for chart
            const principalPercentValue = (principal / totalPay) * 100;
            const interestPercentValue = (totalInt / totalPay) * 100;

            principalBar.style.width = principalPercentValue + '%';
            interestBar.style.width = interestPercentValue + '%';
            principalPercent.textContent = principalPercentValue.toFixed(1) + '%';
            interestPercent.textContent = interestPercentValue.toFixed(1) + '%';
        }

        calculateBtn.addEventListener('click', calculateEMI);
        
        // Update on input change
        loanAmount.addEventListener('input', calculateEMI);
        interestRate.addEventListener('input', calculateEMI);
        loanTenure.addEventListener('input', calculateEMI);

        // Initial calculation
        calculateEMI();
        trackToolUsage('Loan EMI Calculator');
    </script>
</body>
</html>